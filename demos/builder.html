<!DOCTYPE HTML> 
<html lang="en">
	<head>
		<script src="https://github.com/chmille4/Scribl/raw/master/lib/Scribl.events.js" ></script>
		<script src="https://github.com/chmille4/Scribl/raw/master/lib/Scribl.gene.js" ></script> 
		<script src="https://github.com/chmille4/Scribl/raw/master/lib/Scribl.js" ></script>
					<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" ></script>
		<link rel="stylesheet" type="text/css" href="../css/demos.css" />
		
		<script> 

			function draw(canvasName) {  
					
					// Get Canvas and Create Chart
				  	var canvas = document.getElementById(canvasName);  	
					
					// Create Chart
					chart1 = new Scribl(canvas, 500);
					chart1.gene.color = "black";
					
					// Add Genes      position, length, orientation
					gene1 = chart1.addGene( 900,    750 , '-');
					gene2 = chart1.addGene( 3500, 2500, '+');
					gene3 = chart1.addGene( 8100, 1000, '-');
					gene4 = chart1.addGene( 6200, 1500, '+');
					gene5 = chart1.addGene( 1000,  1000, '-');		
					gene6 = chart1.addGene( 3500, 1500, '-');		
					gene7 = chart1.addGene( 2230, 1000, '+');
					gene8 = chart1.addGene( 4500, 1500, '+');				
					gene9 = chart1.addGene( 7230, 1000, '-');

					// add name
					gene3.font.color = "white";
					gene3.name = "Gene 2";
					
					// Draw Chart
					chart1.draw();
					
					// have to reset chart.gene.color to undefined or else it overrides everything downstream ...
					chart1.gene.color = undefined;
			}
			
			function redraw() {
				// changeable options
				roundness = document.getElementById('shapeSlider').value;
				trackSizes = document.getElementById('trackSlider').value;
				r1 = document.getElementById('rSlider1').value;
				g1 = document.getElementById('gSlider1').value;
				b1 = document.getElementById('bSlider1').value;
				r2 = document.getElementById('rSlider2').value;
				g2 = document.getElementById('gSlider2').value;
				b2 = document.getElementById('bSlider2').value;
				canvas = document.getElementById('canvas');
				canvas.height = chart1.chartHeight() + 20;
				
				// set new values
				chart1.gene.roundness = roundness;
				chart1.trackSizes = parseInt(trackSizes);
				
				// assemble color
				top_color = "rgb(" + r1 + ", " + g1 + ", " + b1 + ")";
				bottom_color = "rgb(" + r2 + ", " + g2 + ", " + b2 + ")";	
				
				chart1.gene.linearGradient = [top_color, bottom_color];

				chart1.redraw();
				
				// Create image of chart1
				var img = chart1.canvas.toDataURL("image/png");
				// Add link to download image
				document.getElementById('export').href = img;
			}
				
		</script>

	</head>  
	
	<body onload="draw('canvas')">
		<div id="description">
			<h2>Chart Builder</h2><br/>
			dynamically change ... everything!
		</div><br/>
		<form>
			<div style="margin-left: auto; margin-right: auto; width:40%">
				<div style="float:left">
					<span>Gene Shape</span><br/>
					<input id="shapeSlider" type="range" min="0" max="20" value="6" onchange="redraw()" />
				</div>

				<div style="float:right; margin-left: 5px">
					<span>Gene Color 2</span><br/>
					<span>r</span><input id="rSlider2" type="range" min="0" max="260" value="0" onchange="redraw()" /><br/>
					<span>g</span><input id="gSlider2" type="range" min="0" max="260" value="0" onchange="redraw()" /><br/>
					<span>b</span><input id="bSlider2" type="range" min="0" max="260" value="0" onchange="redraw()" />
				</div>

				<div style="float:right">
					<span>Gene Color 1</span><br/>
					<span>r</span><input id="rSlider1" type="range" min="0" max="260" value="0" onchange="redraw()" /><br/>
					<span>g</span><input id="gSlider1" type="range" min="0" max="260" value="0" onchange="redraw()" /><br/>
					<span>b</span><input id="bSlider1" type="range" min="0" max="260" value="0" onchange="redraw()" />
				</div>
				<div style="float:left">
					<span>Track Size</span><br/>
					<input id="trackSlider" type="range" min="10" max="200" value="70" onchange="redraw()" />
				</div><br/>
				<div style="clear:both"></div> <br/>
			</div>
		<div id="container">
			<canvas id="canvas" width="547" height="330"></canvas>  
					</br><a id="export">Export as PNG (right click Save As)</a>
		</div>

		
	</body>
	
</html>